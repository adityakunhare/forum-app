import{x as A,r as B,j as H,d as m,o as n,b as r,w as p,a as e,u as s,h as L,f as h,t as f,e as c,i as x,c as E,F as k,g as T,W as Z}from"./app-I9ZqX3c1.js";import{u as N,_ as j}from"./AppLayout-BqS6xF6_.js";import{C as D}from"./Container-9vTamMpe.js";import{_ as F,a as W,r as z,b as U}from"./Pill-DxhwC_3L.js";import{_ as I}from"./PrimaryButton-XCZxEjIE.js";import{_ as q}from"./InputError-9_eqJPH4.js";import{_ as G}from"./SecondaryButton-C7sw68SJ.js";import{M as J}from"./MarkdownEditor-CmO1dZHA.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ConfirmationModal-CHwO_YZR.js";import"./Modal-DTB7mvWZ.js";const K=["href"],O={class:"text-2xl font-bold mt-2"},P=["innerHTML"],Q={class:"w-full flex justify-center mt-8 border-t pt-8"},R={class:"max-w-screen-md w-full"},X={key:0,class:"text-xl font-bold"},Y={class:"text-right"},ee={key:2},te={class:"text-left divide-y"},se={class:"flex items-center gap-2 mb-4"},oe=["src"],le={class:"font-bold text-sm"},ae={class:"text-gray-600 text-xs"},ne={key:0},re=["onSubmit"],ie={key:1},me=["onClick"],de=["innerHTML"],ke={__name:"Show",props:["post","comments"],setup(o){let u=o,a=A({body:""}),d=B(null),v=H(()=>u.comments.data.find(i=>i.id===d.value)),b=i=>{var t;d.value=i,a.body=(t=v.value)==null?void 0:t.body},_=()=>{d.value=null,a.reset(),v.value=null},C=()=>{a.post(route("posts.comments.store",u.post.id),{onSuccess:()=>a.reset("body"),preserveScroll:!0})},M=()=>{a.patch(route("comments.update",{comment:d.value,page:u.comments.meta.current_page}),{onSuccess:()=>_(),preserveScroll:!0})},{confirmation:$}=N(),S=async i=>{await $("Are you sure you want to delete the comment?")&&Z.delete(route("comments.destroy",{comment:i,page:u.comments.data.length>1?u.comments.meta.current_page:Math.max(u.comments.meta.current_page-1,1)}),{preserveScroll:!0})};return(i,t)=>(n(),m(k,null,[r(s(L),null,{default:p(()=>[e("link",{rel:"canonical",href:o.post.routes.show},null,8,K)]),_:1}),r(j,{title:o.post.title},{default:p(()=>[r(D,null,{default:p(()=>[r(F,{link:i.route("posts.index",{topic:o.post.topic.slug})},{default:p(()=>[h(f(o.post.topic.name),1)]),_:1},8,["link"]),e("h1",O,f(o.post.title),1),r(W,{created_at:o.post.created_at,user:o.post.user},null,8,["created_at","user"]),e("article",{class:"mt-6 prose prose-sm max-w-none",innerHTML:o.post.html},null,8,P),e("div",Q,[e("div",R,[o.comments.data.length>0?(n(),m("h2",X,"Comments")):c("",!0),i.$page.props.auth.user?(n(),m("form",{key:1,onSubmit:t[2]||(t[2]=x(()=>s(d)?s(M)():s(C)(),["prevent"])),class:"w-full mt-9"},[e("div",null,[r(J,{modelValue:s(a).body,"onUpdate:modelValue":t[0]||(t[0]=l=>s(a).body=l),editorClass:"min-h-[80px]",placeholder:"Write what you think..."},null,8,["modelValue"]),r(q,{message:s(a).errors.body},null,8,["message"])]),e("div",Y,[r(I,{type:"submit",class:"mt-5 flex",disabled:s(a).processing,textContent:f(s(d)?"Update Comment":"Add Comment")},null,8,["disabled","textContent"]),s(d)?(n(),E(G,{key:0,class:"ml-2",onClick:t[1]||(t[1]=l=>s(_)())},{default:p(()=>t[3]||(t[3]=[h("Cancel")])),_:1})):c("",!0)])],32)):c("",!0),o.comments.data.length>0?(n(),m("div",ee,[e("ul",te,[(n(!0),m(k,null,T(o.comments.data,l=>{var g,y,w;return n(),m("div",{key:l.id,class:"px-2 py-4 my-2 hover:text-blue-800"},[e("div",se,[e("span",null,[e("img",{src:l.user.profile_photo_path==null?"https://www.w3schools.com/w3images/avatar6.png":l.user.profile_photo_path,class:"rounded-full h-6"},null,8,oe)]),e("span",le,f((g=l.user)==null?void 0:g.name),1),e("span",ae,f(s(z)(l.created_at))+" ago ",1),(y=l.can)!=null&&y.delete?(n(),m("span",ne,[e("form",{onSubmit:x(V=>s(S)(l.id),["prevent"])},t[4]||(t[4]=[e("button",{type:"submit",title:"Delete"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"size-4 stroke-gray-300 hover:stroke-gray-500"},[e("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])],-1)]),40,re)])):c("",!0),(w=l.can)!=null&&w.edit?(n(),m("span",ie,[e("button",{title:"Edit",onClick:V=>s(b)(l.id)},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.8",stroke:"currentColor",class:"size-4 stroke-gray-500 hover:stroke-gray-600"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})],-1)]),8,me)])):c("",!0)]),e("div",null,[e("div",{class:"mt-1 prose prose-sm max-w-none",innerHTML:l.html},null,8,de),t[6]||(t[6]=h("> "))])])}),128))]),r(U,{meta:o.comments.meta,only:["comments"]},null,8,["meta"])])):c("",!0)])])]),_:1})]),_:1},8,["title"])],64))}};export{ke as default};
