import{x as A,r as B,j as H,d as m,o as n,b as r,w as f,a as e,u as o,h as L,f as h,t as c,e as p,i as w,c as E,F as k,g as T,W as Z}from"./app-BIPkArBk.js";import{u as N,_ as j}from"./AppLayout-CvRHNojt.js";import{C as D}from"./Container-B3yHDWoN.js";import{_ as F,a as W,r as z,b as U}from"./Pill-DIAdTfW1.js";import{_ as I}from"./PrimaryButton-BUacNOM2.js";import{_ as q}from"./InputError-Cv72Upi7.js";import{_ as G}from"./SecondaryButton-tNPV7r4Q.js";import{M as J}from"./MarkdownEditor-Dk_2jnCc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ConfirmationModal-DZwt2xSz.js";import"./Modal-Bo5bVFZr.js";const K=["href"],O={class:"text-2xl font-bold mt-2"},P={class:"mt-4"},Q={class:"text-red-700 font-bold text-sm"},R=["innerHTML"],X={class:"w-full flex justify-center mt-8 border-t pt-8"},Y={class:"max-w-screen-md w-full"},ee={key:0,class:"text-xl font-bold"},te={class:"text-right"},se={key:2},oe={class:"text-left divide-y"},le={class:"flex items-center gap-2 mb-4"},ae=["src"],ne={class:"font-bold text-sm"},re={class:"text-gray-600 text-xs"},ie={key:0},me=["onSubmit"],de={key:1},ue=["onClick"],ce=["innerHTML"],Ce={__name:"Show",props:["post","comments"],setup(s){let u=s,a=A({body:""}),d=B(null),v=H(()=>u.comments.data.find(i=>i.id===d.value)),b=i=>{var t;d.value=i,a.body=(t=v.value)==null?void 0:t.body},_=()=>{d.value=null,a.reset(),v.value=null},C=()=>{a.post(route("posts.comments.store",u.post.id),{onSuccess:()=>a.reset("body"),preserveScroll:!0})},M=()=>{a.patch(route("comments.update",{comment:d.value,page:u.comments.meta.current_page}),{onSuccess:()=>_(),preserveScroll:!0})},{confirmation:$}=N(),S=async i=>{await $("Are you sure you want to delete the comment?")&&Z.delete(route("comments.destroy",{comment:i,page:u.comments.data.length>1?u.comments.meta.current_page:Math.max(u.comments.meta.current_page-1,1)}),{preserveScroll:!0})};return(i,t)=>(n(),m(k,null,[r(o(L),null,{default:f(()=>[e("link",{rel:"canonical",href:s.post.routes.show},null,8,K)]),_:1}),r(j,{title:s.post.title},{default:f(()=>[r(D,null,{default:f(()=>[r(F,{link:i.route("posts.index",{topic:s.post.topic.slug})},{default:f(()=>[h(c(s.post.topic.name),1)]),_:1},8,["link"]),e("h1",O,c(s.post.title),1),r(W,{created_at:s.post.created_at,user:s.post.user},null,8,["created_at","user"]),e("div",P,[e("span",Q,c(s.post.likes_count)+" likes",1)]),e("article",{class:"mt-6 prose prose-sm max-w-none",innerHTML:s.post.html},null,8,R),e("div",X,[e("div",Y,[s.comments.data.length>0?(n(),m("h2",ee,"Comments")):p("",!0),i.$page.props.auth.user?(n(),m("form",{key:1,onSubmit:t[2]||(t[2]=w(()=>o(d)?o(M)():o(C)(),["prevent"])),class:"w-full mt-9"},[e("div",null,[r(J,{modelValue:o(a).body,"onUpdate:modelValue":t[0]||(t[0]=l=>o(a).body=l),editorClass:"min-h-[80px]",placeholder:"Write what you think..."},null,8,["modelValue"]),r(q,{message:o(a).errors.body},null,8,["message"])]),e("div",te,[r(I,{type:"submit",class:"mt-5 flex",disabled:o(a).processing,textContent:c(o(d)?"Update Comment":"Add Comment")},null,8,["disabled","textContent"]),o(d)?(n(),E(G,{key:0,class:"ml-2",onClick:t[1]||(t[1]=l=>o(_)())},{default:f(()=>t[3]||(t[3]=[h("Cancel")])),_:1})):p("",!0)])],32)):p("",!0),s.comments.data.length>0?(n(),m("div",se,[e("ul",oe,[(n(!0),m(k,null,T(s.comments.data,l=>{var g,x,y;return n(),m("div",{key:l.id,class:"px-2 py-4 my-2 hover:text-blue-800"},[e("div",le,[e("span",null,[e("img",{src:l.user.profile_photo_path==null?"https://www.w3schools.com/w3images/avatar6.png":l.user.profile_photo_path,class:"rounded-full h-6"},null,8,ae)]),e("span",ne,c((g=l.user)==null?void 0:g.name),1),e("span",re,c(o(z)(l.created_at))+" ago ",1),(x=l.can)!=null&&x.delete?(n(),m("span",ie,[e("form",{onSubmit:w(V=>o(S)(l.id),["prevent"])},t[4]||(t[4]=[e("button",{type:"submit",title:"Delete"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor",class:"size-4 stroke-gray-300 hover:stroke-gray-500"},[e("path",{"fill-rule":"evenodd",d:"M5 3.25V4H2.75a.75.75 0 0 0 0 1.5h.3l.815 8.15A1.5 1.5 0 0 0 5.357 15h5.285a1.5 1.5 0 0 0 1.493-1.35l.815-8.15h.3a.75.75 0 0 0 0-1.5H11v-.75A2.25 2.25 0 0 0 8.75 1h-1.5A2.25 2.25 0 0 0 5 3.25Zm2.25-.75a.75.75 0 0 0-.75.75V4h3v-.75a.75.75 0 0 0-.75-.75h-1.5ZM6.05 6a.75.75 0 0 1 .787.713l.275 5.5a.75.75 0 0 1-1.498.075l-.275-5.5A.75.75 0 0 1 6.05 6Zm3.9 0a.75.75 0 0 1 .712.787l-.275 5.5a.75.75 0 0 1-1.498-.075l.275-5.5a.75.75 0 0 1 .786-.711Z","clip-rule":"evenodd"})])],-1)]),40,me)])):p("",!0),(y=l.can)!=null&&y.edit?(n(),m("span",de,[e("button",{title:"Edit",onClick:V=>o(b)(l.id)},t[5]||(t[5]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.8",stroke:"currentColor",class:"size-4 stroke-gray-500 hover:stroke-gray-600"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"})],-1)]),8,ue)])):p("",!0)]),e("div",null,[e("div",{class:"mt-1 prose prose-sm max-w-none",innerHTML:l.html},null,8,ce),t[6]||(t[6]=h("> "))])])}),128))]),r(U,{meta:s.comments.meta,only:["comments"]},null,8,["meta"])])):p("",!0)])])]),_:1})]),_:1},8,["title"])],64))}};export{Ce as default};
